# 通道配置

GO_MIDI! 提供 8 个独立通道，每个通道可以配置不同的目标窗口、音轨和移调。这使你可以同时向多个窗口发送不同的按键，或分离播放 MIDI 中的不同音轨。

## 通道概念

### 什么是通道？

通道是一个独立的播放配置单元。每个通道包含：

- **目标窗口**：按键发送到哪个窗口
- **音轨选择**：播放 MIDI 中的哪个音轨
- **移调设置**：音符整体升降多少半音
- **启用状态**：是否激活该通道

### 通道数量

程序提供 **8 个通道**（通道 0 - 通道 7），可以满足大多数场景：

- 单窗口单音轨：使用 1 个通道
- 单窗口多音轨：使用多个通道，选择不同音轨
- 多窗口同时播放：每个窗口配置一个通道

## 通道设置详解

### 启用/禁用

点击通道左侧的按钮启用或禁用该通道：
- **绿色/按下状态**：通道已启用
- **灰色/弹起状态**：通道已禁用

禁用的通道不会发送任何按键。

### 目标窗口

点击「窗口」下拉框选择目标窗口：

1. 点击下拉框展开窗口列表
2. 列表会显示当前所有可操作窗口
3. 选择要发送按键的目标窗口

> 窗口列表会在点击下拉框时自动刷新。如果目标窗口没有显示，请确保它已打开且未被最小化。

### 音轨选择

点击「音轨」下拉框选择播放的音轨：

| 选项 | 说明 |
|------|------|
| **全部音轨** | 播放 MIDI 中所有音轨的音符 |
| **音轨名称** | 只播放该音轨的音符 |

音轨名称通常反映乐器类型，如：
- Piano、Guitar、Violin 等
- MIDI 文件中定义的实际音轨名

> 查看音轨信息：可以在下拉列表中看到每个音轨的音符数量。

### 移调

移调控制音符的整体升降，单位为半音：

- **正值**：升调（音符变高）
- **负值**：降调（音符变低）
- **0**：不移动

#### 使用场景

1. **适配键位范围**：如果 MIDI 音域超出键位映射范围，通过移调调整
2. **配合智能移调**：程序会自动计算最佳移调，通常只需微调

#### 智能移调

程序会根据以下因素自动计算最佳移调：
- 当前键位映射覆盖的音符范围
- MIDI 音轨中音符的分布
- 音高范围设置（可在界面调整）

## 多通道配置示例

### 示例 1：分离左右手

MIDI 文件包含左右手两个音轨，分别发送到同一窗口：

| 通道 | 启用 | 窗口 | 音轨 | 移调 |
|------|------|------|------|------|
| 0 | ✓ | 游戏窗口 | Piano (右手) | 0 |
| 1 | ✓ | 游戏窗口 | Piano (左手) | 0 |

### 示例 2：多游戏窗口

同时在两个游戏窗口演奏：

| 通道 | 启用 | 窗口 | 音轨 | 移调 |
|------|------|------|------|------|
| 0 | ✓ | 游戏窗口 A | 全部音轨 | 0 |
| 1 | ✓ | 游戏窗口 B | 全部音轨 | 0 |

### 示例 3：分轨调试

单独播放某个音轨进行调试：

| 通道 | 启用 | 窗口 | 音轨 | 移调 |
|------|------|------|------|------|
| 0 | ✓ | 游戏窗口 | Guitar | 0 |
| 1 | ✗ | - | - | - |

## 音高范围设置

在播放控制区域可以设置音高范围：

- **最低音高**：音符映射的最低 MIDI 编号
- **最高音高**：音符映射的最高 MIDI 编号

超出此范围的音符会被忽略或移调到范围内。

## 配置保存

每个文件的通道配置会自动保存到 `config.ini`，下次打开同一文件时自动恢复。

配置文件格式：

```ini
[Channel_0]
Window=窗口标题
Track=音轨名称
Transpose=0
Enabled=1

[Channel_1]
Window=窗口标题
Track=全部音轨
Transpose=-12
Enabled=1
```
