# 键位映射

键位映射定义了 MIDI 音符到键盘按键的对应关系。GO_MIDI! 提供灵活的键位配置系统，支持多种格式和修饰键。

## 概念说明

### MIDI 音符编号

MIDI 使用 0-127 的编号表示音符：
- 编号 60 = 中央 C (C4)
- 编号每增加 1，音高升高一个半音
- 编号每增加 12，音高升高一个八度

### 音名表示

音名使用科学音高记号：
- 格式：`音名` + `八度号`
- 音名：C, C#/Db, D, D#/Eb, E, F, F#/Gb, G, G#/Ab, A, A#/Bb, B
- 示例：C4, C#4, Db4, D4, E4, F4, F#4, G4, G#4, A4, A#4, B4, C5

## 键位映射文件

### 文件位置

键位映射文件位于程序同目录：
- 默认文件名：`keymap.txt`
- 可通过「加载键位」按钮加载其他文件

### 文件格式

```
# 注释以 # 开头
# 格式：音符 分隔符 按键

# 使用 MIDI 编号
60: a
62: s
64: d

# 使用音名
C4: a
D4: s
E4: d

# 支持修饰键
C#4: a+    # a + Shift
D#4: d-    # d + Ctrl
```

### 分隔符支持

以下分隔符均可使用（全角半角不限）：

| 分隔符 | 示例 |
|--------|------|
| 冒号 | `60: a` |
| 等号 | `60 = a` |
| 减号 | `60 - a` |
| 空格 | `60 a` |
| 全角冒号 | `60：a` |
| 全角等号 | `60＝a` |

### 修饰键

| 符号 | 修饰键 |
|------|--------|
| `+` | Shift |
| `-` | Ctrl |

示例：
- `a+` = Shift + A
- `a-` = Ctrl + A

## 内置键位

程序内置 FF14 默认键位：

| 音符 | 音名 | 按键 |
|------|------|------|
| 48 | C3 | Z |
| 49 | C#3 | Shift+Z |
| 50 | D3 | X |
| 51 | D#3 | Ctrl+C |
| 52 | E3 | C |
| 53 | F3 | V |
| 54 | F#3 | Shift+V |
| 55 | G3 | B |
| 56 | G#3 | Shift+B |
| 57 | A3 | N |
| 58 | A#3 | Ctrl+M |
| 59 | B3 | M |
| 60 | C4 | A |
| 61 | C#4 | Shift+A |
| 62 | D4 | S |
| 63 | D#4 | Ctrl+D |
| 64 | E4 | D |
| 65 | F4 | F |
| 66 | F#4 | Shift+F |
| 67 | G4 | G |
| 68 | G#4 | Shift+G |
| 69 | A4 | H |
| 70 | A#4 | Ctrl+J |
| 71 | B4 | J |
| 72 | C5 | Q |
| 73 | C#5 | Shift+Q |
| 74 | D5 | W |
| 75 | D#5 | Ctrl+E |
| 76 | E5 | E |
| 77 | F5 | R |
| 78 | F#5 | Shift+R |
| 79 | G5 | T |
| 80 | G#5 | Shift+T |
| 81 | A5 | Y |
| 82 | A#5 | Ctrl+U |
| 83 | B5 | U |

## 键位管理

### 加载键位

1. 点击「加载键位」按钮
2. 选择键位映射文件
3. 键位立即生效

### 保存键位

1. 点击「保存键位」按钮
2. 选择保存位置和文件名
3. 当前键位配置保存到文件

### 重置默认

点击「重置默认」按钮恢复内置的 FF14 键位。

## 游戏键位映射文件

项目提供燕云十六声的键位映射文件：
- 位置：`keymaps/燕云十六声默认键位.txt`
- 使用：加载此文件即可适配燕云十六声游戏

## 自定义键位建议

### 音域规划

1. 确定游戏支持的按键数量
2. 选择合适的音域范围（建议 2-3 个八度）
3. 将常用音符映射到顺手的位置

### 避免冲突

- 不要映射游戏中已有功能的按键
- 避免使用可能触发系统快捷键的组合

### 舒适性

- 将高频音符映射到主键盘区域
- 考虑手指移动距离和舒适度
